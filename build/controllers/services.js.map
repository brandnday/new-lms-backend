{"version":3,"sources":["../../src/controllers/services.js"],"names":["pgPool","isActive","list","ctx","churchid","request","body","requestData","mainQuery","res","query","ok","response","rows","add","servicename","starttime","latetime","endtime","update","editingId","deactivate"],"mappings":"AAAA,SAASA,MAAT,QAAuB,sBAAvB;AACA,MAAMC,WAAY,cAAlB;AACA,OAAO,MAAMC,OAAO,MAAMC,GAAN,IAAa;AAC/B,QAAM,EAAEC,QAAF,KAAeD,IAAIE,OAAJ,CAAYC,IAAZ,CAAiBC,WAAtC;AACA,QAAMC,YAAa;;QAEbP,QAAS,EAFf;AAGA,QAAMQ,MAAM,MAAMT,OAAOU,KAAP,CACf,oDAAmDF,SAAU;gBAD9C,EAGhB,CAACJ,QAAD,CAHgB,CAAlB;AAKAD,MAAIQ,EAAJ,CAAO,EAAEC,UAAU,EAAEC,MAAMJ,IAAII,IAAZ,EAAZ,EAAP;AACD,CAXM;;AAaP,OAAO,MAAMC,MAAM,MAAMX,GAAN,IAAa;AAC9B,QAAM;AACJY,eADI;AAEJC,aAFI;AAGJC,YAHI;AAIJC,WAJI;AAKJd;AALI,MAMFD,IAAIE,OAAJ,CAAYC,IAAZ,CAAiBC,WANrB;AAOA,QAAME,MAAM,MAAMT,OAAOU,KAAP,CACf;6BADe,EAGhB,CAACK,WAAD,EAAcC,SAAd,EAAyBE,OAAzB,EAAkCD,QAAlC,EAA4Cb,QAA5C,CAHgB,CAAlB;AAKAD,MAAIQ,EAAJ,CAAO,EAAEC,UAAUH,IAAII,IAAhB,EAAP;AACD,CAdM;;AAgBP,OAAO,MAAMM,SAAS,MAAMhB,GAAN,IAAa;AACjC,QAAM;AACJY,eADI;AAEJC,aAFI;AAGJC,YAHI;AAIJC,WAJI;AAKJE;AALI,MAMFjB,IAAIE,OAAJ,CAAYC,IAAZ,CAAiBC,WANrB;AAOA,QAAME,MAAM,MAAMT,OAAOU,KAAP,CACf;;;;;gBADe,EAOhB,CAACK,WAAD,EAAcC,SAAd,EAAyBC,QAAzB,EAAmCC,OAAnC,EAA4CE,SAA5C,CAPgB,CAAlB;AASAjB,MAAIQ,EAAJ,CAAO,EAAEC,UAAUH,IAAII,IAAhB,EAAP;AACD,CAlBM;;AAoBP,OAAO,MAAMQ,aAAa,MAAMlB,GAAN,IAAa;AACrC,QAAM,EAAEiB,SAAF,KAAgBjB,IAAIE,OAAJ,CAAYC,IAAZ,CAAiBC,WAAvC;AACA,QAAME,MAAM,MAAMT,OAAOU,KAAP,CACf;cADe,EAGhB,CAACU,SAAD,CAHgB,CAAlB;AAKAjB,MAAIQ,EAAJ,CAAO,EAAEC,UAAUH,IAAII,IAAhB,EAAP;AACD,CARM","file":"services.js","sourcesContent":["import { pgPool } from \"../services/database\";\nconst isActive = `status = 'A'`;\nexport const list = async ctx => {\n  const { churchid } = ctx.request.body.requestData;\n  const mainQuery = `from trservices \n  where churchid = $1\n  AND ${isActive}`;\n  const res = await pgPool.query(\n    `select id,servicename,starttime,endtime,latetime ${mainQuery}\n    ORDER BY id`,\n    [churchid]\n  );\n  ctx.ok({ response: { rows: res.rows } });\n};\n\nexport const add = async ctx => {\n  const {\n    servicename,\n    starttime,\n    latetime,\n    endtime,\n    churchid\n  } = ctx.request.body.requestData;\n  const res = await pgPool.query(\n    `INSERT INTO trservices(servicename,starttime,endtime,latetime,churchid,status)\n  values($1,$2,$3,$4,$5,'A')`,\n    [servicename, starttime, endtime, latetime, churchid]\n  );\n  ctx.ok({ response: res.rows });\n};\n\nexport const update = async ctx => {\n  const {\n    servicename,\n    starttime,\n    latetime,\n    endtime,\n    editingId\n  } = ctx.request.body.requestData;\n  const res = await pgPool.query(\n    `UPDATE trservices SET\n  servicename = $1,\n  starttime = $2,\n  latetime = $3,\n  endtime = $4\n  where id = $5`,\n    [servicename, starttime, latetime, endtime, editingId]\n  );\n  ctx.ok({ response: res.rows });\n};\n\nexport const deactivate = async ctx => {\n  const { editingId } = ctx.request.body.requestData;\n  const res = await pgPool.query(\n    `update trservices set status='D'\n  where id=$1`,\n    [editingId]\n  );\n  ctx.ok({ response: res.rows });\n};\n"]}